# 共享目录

## 一、服务端

```shell
#!/bin/bash

# 安装需要的软件包
yum install -y nfs-utils rpcbind

mkdir -p /software
mkdir -p /data
mkdir -p /log
chmod -R 777 /software
chmod -R 777 /data
chmod -R 777 /log


echo "/software 192.168.145.0/24(rw,sync,no_root_squash,no_all_squash)" >> /etc/exports
echo "/data 192.168.145.0/24(rw,sync,no_root_squash,no_all_squash)" >> /etc/exports
echo "/log 192.168.145.0/24(rw,sync,no_root_squash,no_all_squash)" >> /etc/exports


# 先启动rpcbind（NFS依赖）
systemctl start rpcbind
systemctl enable rpcbind

# 启动nfs-server
systemctl start nfs-server
systemctl enable nfs-server

# 重新加载exports配置（修改配置后执行）
exportfs -rv

# 查看共享目录配置
# exportfs -v
# 输出示例：/software       192.168.145.0/24(sync,wdelay,hide,no_subtree_check,sec=sys,rw,secure,no_root_squash,no_all_squash)

# 查看NFS端口监听
# rpcinfo -p localhost
# 需看到nfs、mountd、rpcbind等服务的端口信息

```

## 二、客户端

```shell
#!/bin/bash

yum install -y nfs-utils rpcbind
# 启动rpcbind
systemctl start rpcbind
systemctl enable rpcbind

# 查看服务端可挂载的目录
# showmount -e 192.168.145.16
# 输出示例：
# Export list for 192.168.145.11:
# /software      192.168.145.0/24

# 自定义本地目录（与服务端对应）
mkdir -p /software
mkdir -p /data
mkdir -p /log
chmod -R 777 /software
chmod -R 777 /data
chmod -R 777 /log

# 编辑fstab文件
echo "192.168.145.16:/software  /software  nfs  defaults  0 0" >> /etc/fstab
echo "192.168.145.16:/data  /data  nfs  defaults  0 0" >> /etc/fstab
echo "192.168.145.16:/log  /log  nfs  defaults  0 0" >> /etc/fstab

# 生效挂载（无需重启）
mount -a

# 查看挂载信息
# df -h
# 输出示例：192.168.145.11:/software   96G   13G   83G  14% /software

# 测试读写（创建文件）
# touch /software/test.txt
# echo "test nfs" > /software/test.txt
# 回到服务端查看文件是否存在，确认共享生效
```

