# Shellç¼–ç¨‹

## ä¸€ã€ä»‹ç»

shellæ˜¯ä¸€ä¸ªç¨‹åºï¼Œé‡‡ç”¨Cè¯­è¨€ç¼–å†™ï¼Œæ˜¯ç”¨æˆ·å’ŒLinuxå†…æ ¸æ²Ÿé€šçš„æ¡¥æ¢ï¼Œå®ƒæ—¢æ˜¯ä¸€ç§å‘½ä»¤è¯­è¨€ï¼Œåˆæ˜¯ä¸€ç§è§£é‡Šæ€§çš„ç¼–ç¨‹è¯­è¨€ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º

![](./doc/01.png)

**shellè„šæœ¬å…·æœ‰å¦‚ä¸‹åŠŸèƒ½**

- å‘½ä»¤è¡Œè§£é‡ŠåŠŸèƒ½
- å¯åŠ¨ç¨‹åº
- è¾“å…¥è¾“å‡ºé‡å®šå‘
- ç®¡é“è¿æ¥
- æ–‡ä»¶åæ›¿æ¢(echo /*)
- å˜é‡ç»´æŠ¤
- ç¯å¢ƒæ§åˆ¶

## äºŒã€shellä¸­çš„ç‰¹æ®Šç¬¦å·

| ç¬¦å·            | å«ä¹‰                                                         |
| --------------- | ------------------------------------------------------------ |
| #               | æ³¨é‡Šä½œç”¨, #! é™¤å¤–                                            |
| ;               | å‘½ä»¤è¡Œåˆ†éš”ç¬¦, å¯ä»¥åœ¨ä¸€è¡Œä¸­å†™å¤šä¸ªå‘½ä»¤. ä¾‹å¦‚p1;p2è¡¨ç¤ºå…ˆæ‰§è¡Œp1,å†æ‰§è¡Œp2 |
| ;;              | è¿ç»­åˆ†å· ,ç»ˆæ­¢ case é€‰é¡¹                                     |
| ""              | åŒå¼•å·ï¼Œè½¯è½¬ä¹‰ï¼Œè§£é‡Šå˜é‡çš„å†…å®¹                               |
| ''              | å•å¼•å·ï¼Œç¡¬è½¬ä¹‰ï¼Œå†…å®¹åŸæ ·è¾“å‡ºï¼Œä¸è§£é‡Šå˜é‡                     |
| \|              | ç®¡é“, åˆ†æå‰è¾¹å‘½ä»¤çš„è¾“å‡º, å¹¶å°†è¾“å‡ºä½œä¸ºåè¾¹å‘½ä»¤çš„è¾“å…¥.        |
| >\|             | å¼ºåˆ¶é‡å®šå‘                                                   |
| \|\|            | é€»è¾‘æˆ–                                                       |
| ()              | æŒ‡ä»¤æ•°ç»„ ,ç”¨æ‹¬å·å°†ä¸€ä¸²è¿ç»­æŒ‡ä»¤æ‹¬èµ·æ¥,å¦‚ ``` (cd ~ ; vcgh=`pwd` ;echo $vcgh)``` |
| $()             | ``` ä¸ `` ä¸€æ ·ï¼Œå‘½ä»¤æ›¿æ¢```                                  |
| ${}             | ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ$varä¸${var}æ˜¯æ²¡æœ‰åŒºåˆ«çš„ï¼Œä½†æ˜¯ç”¨${ }ä¼šæ¯”è¾ƒç²¾ç¡®çš„ç•Œå®šå˜é‡åç§°çš„èŒƒå›´ã€‚å¦‚`A=Linux;echo $AB(æ— è¾“å‡º) # è¡¨ç¤ºå˜é‡AB.  echo ${A}B  è¾“å‡ºï¼šLinuxB # è¡¨ç¤ºå˜é‡Aåè¿æ¥ç€B` |
| $[]             | è®¡ç®—é€»è¾‘è¡¨è¾¾ç¤º `a=1; echo $[a+1]; è¾“å‡º2`                     |
| (())            | forå¾ªç¯ä¸­Cè¯­è¨€æ ¼å¼è¯­æ³•                                       |
| $(())           | è®¡ç®—æ•°å­¦è¡¨è¾¾å¼                                               |
| $0              | å½“å‰æ‰§è¡Œçš„è¿›ç¨‹/ç¨‹åºå                                        |
| $#              | è„šæœ¬åé¢æ¥çš„å‚æ•°çš„ä¸ªæ•°                                       |
| $*              | å‚æ•°åˆ—è¡¨ï¼ŒåŒå¼•å·å¼•ç”¨ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²                             |
| $@              | è„šæœ¬åé¢æ‰€æœ‰å‚æ•°ï¼Œå‚æ•°æ˜¯ç‹¬ç«‹çš„ï¼Œä¹Ÿæ˜¯å…¨éƒ¨è¾“å‡º                 |
| $$              | å½“å‰æ‰€åœ¨è¿›ç¨‹çš„è¿›ç¨‹å·                                         |
| $?              | ä¸Šä¸€ä¸ªå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ 0æˆåŠŸï¼Œ other å¤±è´¥                      |
| $!              | åå°è¿è¡Œçš„æœ€åä¸€ä¸ªè¿›ç¨‹çš„è¿›ç¨‹IDå·                             |
| !$              | è°ƒç”¨æœ€åä¸€æ¡å‘½ä»¤å†å²ä¸­çš„å‚æ•°                                 |
| !               | æ‰§è¡Œå†å²è®°å½•ä¸­çš„å‘½ä»¤ : ! å‘½ä»¤id                              |
| !!              | æ‰§è¡Œä¸Šä¸€æ¡å‘½ä»¤                                               |
| []              | è®¡ç®—é€»è¾‘è¡¨è¾¾å¼ï¼Œä¸ test ä¸€æ ·, å¦‚ ` test -d /root/` ç­‰åŒäº ` [-d /root/]` |
| [[]]            | å­—ç¬¦ä¸²åŒ¹é…                                                   |
| &               | åå°è¿è¡Œå‘½ä»¤                                                 |
| &&              | é€»è¾‘ä¸                                                       |
| >               | é‡å®šå‘è¾“å…¥ è¦†ç›–åŸæ•°æ®                                        |
| >>              | é‡å®šå‘è¿½åŠ è¾“å…¥ï¼Œåœ¨åŸæ•°æ®çš„æœ«å°¾æ·»åŠ                            |
| <               | é‡å®šå‘è¾“å‡º  ä¾‹å¦‚ï¼š wc -l < /etc/paawd                        |
| <<              | é‡å®šå‘è¿½åŠ è¾“å‡º  ä¾‹å¦‚: fdisk /dev/sdb <<EOF ... EOF # è¿½åŠ è¾“å…¥çš„å†…å®¹ä¸º fdisk éœ€è¦çš„å‚æ•° |
| 1               | æ ‡å‡†è¾“å‡º                                                     |
| 2               | æ ‡å‡†é”™è¯¯è¾“å‡º                                                 |
| >/dev/null 2>&1 | æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯éƒ½é‡å®šå‘åˆ°äº†/dev/null                      |
| 2>&1 >/dev/null | æ„æ€æ˜¯æŠŠæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºåé‡å®šå‘åˆ°/dev/null      |
| 1>&2 >/dev/null | æ„æ€æ˜¯æŠŠæ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†é”™è¯¯åé‡å®šå‘åˆ°/dev/null          |
| &> /dev/null    | ä¸ç®¡ä½ æ˜¯å•¥ç©æ„å„¿æ–‡ä»¶æè¿°ç¬¦ï¼Œé€šé€šé‡å®šå‘åˆ°/dev/null            |

## ä¸‰ã€æ ¼å¼åŒ–è¾“å…¥è¾“å‡º

**æ ¼å¼åŒ–è¾“å‡ºï¼š echo** 

- -n ä¸è¦è‡ªåŠ¨æ¢è¡Œ

```shell
[root@node01 ~]# echo  "date: ";date +%F
date: 
2021-11-02


[root@node01 ~]# echo -n "date: ";date +%F # ä¸è‡ªåŠ¨æ¢è¡Œ
date:2021-11-02
```

- -e è§£é‡Šè½¬ä¹‰å­—ç¬¦

```shell
[root@hadoop101 ~]# echo "\n hello world"
\n hello world
[root@hadoop101 ~]# echo -e "\n hello world"  # è§£é‡Šè½¬ä¹‰å­—ç¬¦

 hello world
```

å¸¸è§çš„è½¬ä¹‰å­—ç¬¦ï¼š 

- \a å‘å‡ºå‘Šè­¦å£°


- \b åˆ é™¤å‰ä¸€ä¸ªå­—ç¬¦


- \t æ’å…¥ tab


- \n æ¢è¡Œä¸”å…‰æ ‡ç§»åŠ¨åˆ°è¡Œé¦–


```shell
# å€’è®¡æ—¶è„šæœ¬
# time.sh

#!/bin/bash
for time in `seq 9 -1 0`;do
	echo -n -e "\b$time"
	sleep 1
done

echo
```

**é¢œè‰²ä»£ç **

```shell
æ ¼å¼å¦‚ä¸‹ï¼š
echo -e "\033[èƒŒæ™¯è‰²;å­—ä½“é¢œè‰² må­—ç¬¦ä¸² \033[0m"

ä¾‹å¦‚:
echo -e "\033[41;36m Hello World\033[0m"

å…¶ä¸­
41 ä»£è¡¨æ–‡å­—èƒŒæ™¯è‰²
36 ä»£ç å­—ä½“é¢œè‰²
å­—ç¬¦ä¸²å‰åå¯ä»¥æ²¡æœ‰ç©ºæ ¼ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œè¾“å‡ºä¹ŸåŒæ ·æœ‰ç©ºæ ¼

å­—ä½“é¢œè‰²ï¼š 30-37
å­—ä½“èƒŒæ™¯è‰²ï¼š 40-47

æœ€åé¢çš„æ§åˆ¶é€‰é¡¹è¯´æ˜
\033[0m å…³é—­æ‰€æœ‰å±æ€§
\033[1m è®¾ç½®é«˜äº®åº¦
\033[4m ä¸‹åˆ’çº¿
\033[5m é—ªçƒ
\033[7m åæ˜¾
\033[8m æ¶ˆéš
```

**æ ¼å¼åŒ–è¾“å…¥ï¼š  read**

-p æ‰“å°ä¿¡æ¯

-t é™å®šæ—¶é—´

-s ä¸æ˜¾ç¤ºè¾“å…¥çš„å†…å®¹

-n é™åˆ¶è¾“å…¥å­—ç¬¦çš„ä¸ªæ•°

```shell
# æ¨¡æ‹Ÿç™»é™†ç•Œé¢

#!/bin/bash

IP=`ifconfig ens33|egrep -w "inet"|awk '{print $2}'`

#1ã€æ¸…å±
clear
#2ã€è¾“å‡ºæç¤ºä¿¡æ¯
echo "CentOS Linux 8 (Core)"
echo -e "Kernel `uname -r` on an `uname -m`\n"

echo -e "Web console: https://localhost:9090/ or https://$IP:9090/ \n"

#3ã€äº¤äº’è¾“å…¥ç™»é™†å
echo -n "$HOSTNAME login: "
read account

#4ã€äº¤äº’è¾“å…¥å¯†ç 
read -s -t30 -p "Password: " pw
echo
```

## å››ã€å˜é‡

å˜é‡æ˜¯åœ¨ç¼–ç¨‹ä¸­æœ€å¸¸ç”¨çš„ä¸€ç§ä¸´æ—¶åœ¨å†…å­˜ä¸­å­˜å–æ•°æ®çš„æ–¹å¼

### (ä¸€)ã€å‘½åè§„åˆ™

- åªèƒ½ç”¨è‹±æ–‡å­—æ¯ï¼Œæ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œä¸èƒ½ä»¥æ•°å­—å¼€å¤´
- å˜é‡åå’Œ"="ä¸­é—´ä¸èƒ½æœ‰ç©ºæ ¼
- ä¸èƒ½ä½¿ç”¨bashé‡Œçš„å…³é”®å­—

### (äºŒ)ã€å˜é‡çš„è®¾ç½®ä¸å–æ¶ˆ

```shell
name="zhangsan" # è®¾ç½®å˜é‡
echo $name
unset name # å–æ¶ˆå˜é‡
```

### (ä¸‰)ã€æœ‰ç±»å‹å˜é‡ declare

- -i  å°†å˜é‡çœ‹æˆæ•´æ•°
- -r  ä½¿å˜é‡åªè¯»ï¼Œ è¯¥å˜é‡çš„å€¼æ— æ³•æ›´æ”¹ï¼Œä¸”ä¸èƒ½ unset
- -x  æ ‡è®°å˜é‡é€šè¿‡ç¯å¢ƒå¯¼å‡º export
- -a  æŒ‡å®šä¸ºç´¢å¼•æ•°ç»„
- -A  æŒ‡å®šä¸ºå…³è”æ•°ç»„

### (å››)ã€å˜é‡åˆ†ç±»

1. æœ¬åœ°å˜é‡ï¼šç”¨æˆ·è‡ªå®šä¹‰çš„å˜é‡ï¼Œå®šä¹‰åœ¨è„šæœ¬æˆ–è€…å½“å‰ç»ˆç«¯ä¸­ï¼Œè„šæœ¬æ‰§è¡Œå®Œæ¯•åæˆ–ç»ˆç«¯ç»“æŸåå˜é‡å¤±æ•ˆ

2. ç¯å¢ƒå˜é‡ï¼šå®šä¹‰åœ¨ç”¨æˆ·å®¶ç›®å½•ä¸‹çš„ .bashrc æˆ–è€… bash_profile æ–‡ä»¶ä¸­ï¼Œç”¨æˆ·ç§æœ‰å˜é‡ï¼Œåªèƒ½æœ¬ç”¨æˆ·ä½¿ç”¨

   - env   :   æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„ç¯å¢ƒå˜é‡
   - set    :   æŸ¥è¯¢å½“å‰ç”¨æˆ·çš„æ‰€æœ‰å˜é‡ï¼ˆä¸´æ—¶å˜é‡ä¸ç¯å¢ƒå˜é‡ï¼‰

3. export å°†å½“å‰å˜é‡å˜æˆç¯å¢ƒå˜é‡

   è¿è¡Œ shell è„šæœ¬æ—¶ï¼Œ ç³»ç»Ÿå°†åˆ›å»ºä¸€ä¸ªå­shellï¼Œæ­¤æ—¶ï¼Œç³»ç»Ÿä¸­å°†æœ‰ä¸¤ä¸ª shell ï¼Œ ä¸€ä¸ªæ˜¯ç™»å½•æ—¶ç³»ç»Ÿå¯åŠ¨çš„shellï¼ˆçˆ¶shellï¼‰, å¦ä¸€ä¸ªæ˜¯ç³»ç»Ÿä¸ºè¿è¡Œè„šæœ¬ç¨‹åºåˆ›å»ºçš„ shell ï¼ˆå­shellï¼‰ï¼Œ ä¸¤ä¸ª shell åœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­æœ¬åœ°å˜é‡æ˜¯ä¸èƒ½å¤Ÿå…±ç”¨çš„ï¼Œåªæœ‰ç¯å¢ƒå˜é‡èƒ½å…±ç”¨ã€‚

   å½“åœ¨çˆ¶shellä¸­åˆ›å»ºäº†ä¸€ä¸ªæœ¬åœ°å˜é‡å’Œä¸€ä¸ªç¯å¢ƒå˜é‡æ—¶ï¼Œè„šæœ¬èƒ½è°ƒç”¨ç¯å¢ƒå˜é‡ï¼Œä½†æ˜¯ä¸èƒ½è°ƒç”¨æœ¬åœ°å˜é‡ã€‚å› ä¸ºæœ¬åœ°å˜é‡ä¸èƒ½èµ‹å€¼ç»™å­ shell ï¼Œè€Œçˆ¶ shell å¯ä»¥æŠŠç¯å¢ƒå˜é‡èµ‹å€¼ç»™å­ shell.

   ```shell
   [hadoop@hadoop101 ~]$ _age=18
   [hadoop@hadoop101 ~]$ export _name='zhangsan'
   [hadoop@hadoop101 ~]$ vi test.sh 
   echo $_age
   echo $_name
   [hadoop@hadoop101 ~]$ vi test.sh 
   [hadoop@hadoop101 ~]$ bash test.sh 
   
   zhangsan
   
   #ä»è„šæœ¬æ‰§è¡Œçš„ç»“æœæ¥çœ‹ï¼Œåªæœ‰ç¯å¢ƒå˜é‡æ‰“å°å‡ºæ¥äº†
   ```

4. å…¨å±€å˜é‡ï¼šæ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥ä½¿ç”¨ï¼Œä¿å­˜åœ¨ /etc/profileã€/etc/bashrcæ–‡ä»¶ä¸­

   - printenv  :   æ‰“å°å…¨å±€å˜é‡

5. å†…ç½®å˜é‡

   å†…ç½®shellä¸­çš„å˜é‡ï¼Œä¹Ÿç§°ä¸ºç³»ç»Ÿå˜é‡ï¼Œ shell æœ¬èº«å·²å®šä¹‰å¥½äº†å®ƒçš„åå­—å’Œä½œç”¨

   å¦‚  $?ã€ $# ã€ $@ ç­‰

   ```shell
   cat 2.sh 
   #!/bin/bash
   echo "\$0 = $0"
   echo "\$# = $#"
   echo "\$* = $*"
   echo "\$@ = $@"
   echo "\$1 = $1"
   echo "\$2 = $2"
   echo "\$3 = $3"
   echo "\$11 = ${11}"
   echo "\$12 = ${12}"
   
   bash 2.sh a b c d e f g h i j k l m n
   $0 = 2.sh
   $# = 14
   $* = a b c d e f g h i j k l m n
   $@ = a b c d e f g h i j k l m n
   $1 = a
   $2 = b
   $3 = c
   $11 = k
   $12 = l
   ```

   $* ä¸ $# çš„åŒºåˆ«

   $*  :  è¡¨ç¤ºå°†å˜é‡çœ‹æˆä¸€ä¸ªæ•´ä½“ 

   $#  :   è¡¨ç¤ºå˜é‡æ˜¯ç‹¬ç«‹çš„

## äº”ã€Shellä¸­çš„è¿ç®—

### (ä¸€)ã€æ•°å­¦è¿ç®—

**å››åˆ™è¿ç®—ç¬¦ï¼š** + - * \ ã€åŠ å‡ä¹˜é™¤ã€‘

**æ‰©å±•ï¼š** % ** ã€å–ä½™ å¼€æ–¹ã€‘

**è¿ç®—å‘½ä»¤:**

- æ•´å½¢è¿ç®—
  
  â€“ expr
  
  â€“ let
  
  â€“ $(())
  
  â€“ bc
  
- æµ®ç‚¹è¿ç®—
  
  â€“ bc

```shell
 # expr å‘½ä»¤: åªèƒ½åšæ•´æ•°è¿ç®—ï¼Œ æ³¨æ„ç©ºæ ¼
[root@node01 ~]# expr 1 + 1
2
[root@node01 ~]# expr 5 \* 2  # ä¹˜æ³•è¿ç®—éœ€è¦è½¬ä¹‰
10

# letå‘½ä»¤:åªèƒ½åšæ•´æ•°è¿ç®—ï¼Œä¸”è¿ç®—å…ƒç´ å¿…é¡»æ˜¯å˜é‡ï¼Œæ— æ³•ç›´æ¥å¯¹æ•´æ•°åšè¿ç®—
[root@node01 ~]# let a=100+3;echo $a
103
[root@node01 ~]# let a++;echo $a
104
[root@node01 ~]# let a--;echo $a
103

# åŒå°åœ†æ‹¬å·è¿ç®—ï¼Œåœ¨shellä¸­(( ))ä¹Ÿå¯ä»¥ç”¨æ¥åšæ•°å­¦è¿ç®—
[root@node01 ~]# echo $((100+3)) 
103

# æµ®ç‚¹æ•°æ¯”è¾ƒ
# bc æ˜¯linux æ–‡ä»¶ç•Œé¢çš„è®¡ç®—å™¨ï¼Œ æ£€æŸ¥æœºå™¨æœ‰æ²¡æœ‰å®‰è£… bc
[root@node01 ~]# rpm -qf `which bc` # æ£€æŸ¥æœºå™¨æœ‰æ²¡æœ‰å®‰è£…bc
[root@node01 ~]# yum -y install bc # å¦‚æœæ²¡æœ‰å®‰è£…å°±æ‰‹åŠ¨å®‰è£…ä¸‹

[hadoop@hadoop101 ~]$ bc
bc 1.06.95
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006 Free Software Foundation, Inc.
This is free software with ABSOLUTELY NO WARRANTY.
For details type `warranty'. 
1+2+3
6


1.2+1.3
2.5

scale=2  # é™¤æ³•è¿ç®—æ—¶å¯ä»¥æŒ‡å®šä¿ç•™çš„å°æ•°èŒƒå›´
100/3
33.33

quit

[root@node01 ~]# echo "scale=3;100/3"|bc
33.333
[root@node01 ~]# echo "0.3 > 0.2"|bc  # å¤§äºè¿”å›1
1
[root@node01 ~]# echo "0.1 > 0.2"|bc # å°äºè¿”å› 0
0
```

### (äºŒ)ã€æ¯”è¾ƒè¿ç®—

#### æ•´å½¢æ¯”è¾ƒ

```
è¿ç®—ç¬¦è§£é‡Šï¼š

 ç²¾ç¡®æ¯”è¾ƒ
        -eq         ç­‰äº equal

        -gt         å¤§äº

        -lt         å°äº

 æ¨¡ç³Šæ¯”è¾ƒ
        -ge         å¤§äºæˆ–ç­‰äº

        -le         å°äºæˆ–ç­‰äº

        -ne         ä¸ç­‰äº
```

```shell
[root@zutuanxue ~]# test 100 -gt 300;echo $?
1
[root@zutuanxue ~]# test 100 -ge 300;echo $?
1
[root@zutuanxue ~]# test 100 -eq 300;echo $?
1
[root@zutuanxue ~]# test 100 -le 300;echo $?
0
[root@zutuanxue ~]# test 100 -lt 300;echo $?
0
[root@zutuanxue ~]# test 100 -ne 300;echo $?
0

å¤‡æ³¨ï¼šlinuxå‘½ä»¤teståªèƒ½æ¯”è¾ƒä¸¤ä¸ªæ•´æ•°çš„å…³ç³»ï¼Œä¸ä¼šè¿”å›ç»“æœï¼Œéœ€è¦é€šè¿‡$?æ‰èƒ½çœ‹åˆ°ç»“æœ
```

#### å­—ç¬¦ä¸²æ¯”è¾ƒ

å­—ç¬¦ä¸²å¿…é¡»åŠ å¼•å·ï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸­æœ‰å˜é‡ï¼ŒåŠ åŒå¼•å·

	== ç­‰äº
	!= ä¸ç­‰äº
	-n æ£€æŸ¥å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦å¤§äº0
	-z æ£€æŸ¥å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦ç­‰äº0
### (ä¸‰)ã€é€»è¾‘è¿ç®—

- é€»è¾‘ä¸è¿ç®— &&

- é€»è¾‘æˆ–è¿ç®— ||

- é€»è¾‘éè¿ç®— ï¼

  ```
  é€»è¾‘è¿ç®—æ³¨æ„äº‹é¡¹ï¼š
      é€»è¾‘ä¸ æˆ– è¿ç®—éƒ½éœ€è¦ä¸¤ä¸ªæˆ–ä»¥ä¸Šæ¡ä»¶
      é€»è¾‘éè¿ç®—åªèƒ½ä¸€ä¸ªæ¡ä»¶ã€‚
      å£è¯€:     é€»è¾‘ä¸è¿ç®—               çœŸçœŸä¸ºçœŸ çœŸå‡ä¸ºå‡   å‡å‡ä¸ºå‡
               é€»è¾‘æˆ–è¿ç®—               çœŸçœŸä¸ºçœŸ çœŸå‡ä¸ºçœŸ   å‡å‡ä¸ºå‡
               é€»è¾‘éè¿ç®—               éå‡ä¸ºçœŸ   éçœŸä¸ºå‡
               
               
  é€»è¾‘ä¸æˆ–çš„çŸ­è·¯è¿ç®—
  é€»è¾‘ä¸ä¸­é å‰çš„æ¡ä»¶ä¸­å‡ºç°äº†å‡ï¼Œåé¢çš„å°±ä¸åœ¨åˆ¤æ–­äº†ï¼Œå› ä¸ºå·²ç»æ˜¯å‡çš„äº†
  é€»è¾‘æˆ–ä¸­é å‰çš„æ¡ä»¶ä¸­å‡ºç°äº†çœŸï¼Œåä¸åœ¨å¾€ååˆ¤æ–­äº†ï¼Œç»“æœå·²ç»ä¸ºçœŸäº†
  ```

### (å››)ã€æ–‡ä»¶ç±»å‹ã€æƒé™ã€æ–°æ—§åˆ¤æ–­

teståˆ¤æ–­å‘½ä»¤ :  æ£€æµ‹æ–‡ä»¶ç±»å‹å’Œæ¯”è¾ƒè¿ç®—

```shell
-d  æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”ä¸ºç›®å½•
-e  æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
-f  æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”ä¸ºæ–‡ä»¶
-r  æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”å¯è¯»
-s  æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”ä¸ä¸ºç©º
-w  æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”å¯å†™
-x  æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”å¯æ‰§è¡Œ
-O  æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨å¹¶ä¸”è¢«å½“å‰ç”¨æˆ·æ‹¥æœ‰
-G  æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨å¹¶ä¸”é»˜è®¤ç»„ä¸ºå½“å‰ç”¨æˆ·ç»„
-nt file1 -nt file2  æ£€æŸ¥file1æ˜¯å¦æ¯”file2æ–°
-ot file1 -ot file2  æ£€æŸ¥file1æ˜¯å¦æ¯”file2æ—§     
-ef file1 -ef file2  æ£€æŸ¥file1æ˜¯å¦ä¸file2æ˜¯åŒä¸€ä¸ªæ–‡ä»¶ï¼Œåˆ¤å®šä¾æ®çš„æ˜¯ièŠ‚ç‚¹
```

```shell
æ–‡ä»¶ç±»å‹
[root@zutuanxue ~]# test -f /etc/passwd;echo $?
0
[root@zutuanxue ~]# test -f /etc;echo $?
1
[root@zutuanxue ~]# test -d /etc;echo $?
0

æƒé™åˆ¤æ–­
[root@zutuanxue ~]# test -x /root/anaconda-ks.cfg ;echo $?
1
[root@zutuanxue ~]# ll /root/anaconda-ks.cfg 
-rw-------. 1 root root 1216 6æœˆ  26 09:06 /root/anaconda-ks.cfg
[root@zutuanxue ~]# test -r /root/anaconda-ks.cfg ;echo $?
0

[root@zutuanxue ~]# test -w /root/anaconda-ks.cfg ;echo $?
0
```

## å…­ã€æ•°ç»„

æ•°ç»„å¯ä»¥è®©ç”¨æˆ·ä¸€æ¬¡èµ‹äºˆå¤šä¸ªå€¼ï¼Œéœ€è¦è¯»å–æ•°æ®æ—¶åªéœ€é€šè¿‡ç´¢å¼•è°ƒç”¨å°±å¯ä»¥æ–¹ä¾¿è¯»å‡ºäº†ã€‚

æ™®é€šæ•°ç»„ï¼šåªèƒ½ä½¿ç”¨æ•´æ•°ä½œä¸ºæ•°ç»„ç´¢å¼•(å…ƒç´ çš„ç´¢å¼•)

å…³è”æ•°ç»„ï¼šå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸ºæ•°ç»„ç´¢å¼•(å…ƒç´ çš„ç´¢å¼•)

### æ™®é€šæ•°ç»„

**æ•°ç»„å®šä¹‰æ–¹å¼**

```
æ•°ç»„åç§°=(å…ƒç´ 1, å…ƒç´ 2ï¼Œ å…ƒç´ 3)
```

**èµ‹å€¼æ–¹å¼**

- ä¸€æ¬¡èµ‹ä¸€ä¸ªå€¼

  ```shell
  å˜é‡å=å˜é‡å€¼
  array[0]=v1
  array[1]=v2
  array[3]=v3
  ```

- ä¸€æ¬¡èµ‹å¤šä¸ªå€¼

  ```shell
  array=(var1 var2 var3 var4)
  array1=(`cat /etc/passwd`)			# å°†æ–‡ä»¶ä¸­æ¯ä¸€è¡Œèµ‹å€¼ç»™array1æ•°ç»„
  array2=(`ls /root`)                 # å°†å‘½ä»¤çš„æ‰§è¡Œç»“æœä¿å­˜åˆ°æ•°ç»„ä¸­
  array3=(harry amy jack "Miss zhang")
  array4=(1 2 3 4 "hello world" [10]=linux)
  ```

**å–å€¼æ–¹å¼**

```shell
# æ ¼å¼
${æ•°ç»„åç§°[ç´¢å¼•]}
é»˜è®¤ç´¢å¼•ä»0å¼€å§‹

# æ ¹æ®ä¸‹æ ‡è®¿é—®å…ƒç´ 
array=(1 3 4 5 6)
echo "è®¿é—®ç¬¬äºŒä¸ªå…ƒç´  ${array[1]}"

# ç»Ÿè®¡æ•°ç»„å…ƒç´ çš„ä¸ªæ•°
echo ${#array[@]}
echo ${#array[*]}

# è®¿é—®æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ 
echo ${array[@]}
echo ${array[*]}

# è·å–æ•°ç»„å…ƒç´ çš„ç´¢å¼•
echo ${!array[@]}

# åˆ‡ç‰‡è·å–éƒ¨åˆ†æ•°ç»„å…ƒç´ 
# ${array[@]:èµ·å§‹ä½ç½®ï¼šç»ˆæ­¢ä½ç½®ï¼š}æˆ–${array[*]:èµ·å§‹ä½ç½®ï¼šç»ˆæ­¢ä½ç½®}
program=(c c++ c# java python PHP perl go .net js shell)
echo "ç¬¬ä¸‰åˆ°ç¬¬å…­çš„è¯­è¨€ä¸ºï¼š${program[*]:2:5}"
echo "ç¬¬ä¸ƒåˆ°ç¬¬åä¸€çš„è¯­è¨€ä¸ºï¼š${program[@]:6:10}"
```

### å…³è”æ•°ç»„

å¯ä»¥è‡ªå®šä¹‰ç´¢å¼•ï¼Œ å£°æ˜æ–¹å¼ `declare -A æ•°ç»„åç§°`

**èµ‹å€¼**

```
èµ‹å€¼æ–¹å¼1
	  å…ˆå£°æ˜å†åˆå§‹åŒ–ï¼Œä¾‹å¦‚ï¼š
      declare -A mydict    #å£°æ˜
      mydict["name"]=guess
      mydict["old"]=18
      mydict["favourite"]=coconut

èµ‹å€¼æ–¹å¼2ï¼š
	ä»¥ç´¢å¼•æ•°ç»„æ ¼å¼å®šä¹‰ï¼Œåªä¸è¿‡å…ƒç´ å˜æˆäº†é”®å€¼å¯¹ï¼Œè¿™ç§æ–¹å¼ä¸éœ€è¦å…ˆå£°æ˜ï¼Œä¾‹å¦‚ï¼š
ã€€ã€€mydict=(["name"]=guess ["old"]=18 ["favourite"]=coconut] ["my description"]="I am a student")

    ä¹Ÿå¯ä»¥å£°æ˜å¹¶åŒæ—¶èµ‹å€¼ï¼š 
ã€€ã€€declare -A mydict=(["name"]=guess ["old"]=18 ["favourite"]=coconut ["my description"]="I am a student")

    æ–¹å¼2ä¸­ï¼Œå’Œç´¢å¼•æ•°ç»„å®šä¹‰æ–¹å¼ä¸€æ ·ï¼Œæ•°ç»„åç§°=(å…ƒç´ 1 å…ƒç´ 2 å…ƒç´ 3)ï¼Œä½†æ‹¬å·å†…éƒ¨å…ƒç´ æ ¼å¼ä¸åŒã€‚å…ƒç´ æ ¼å¼ä¸ºï¼š["é”®"]=å€¼ï¼Œå…ƒç´ é”®å€¼å¯¹ä¹‹é—´ä»¥ç©ºæ ¼åˆ†éš”ã€‚
```

ä¸€æ¬¡èµ‹ä¸€ä¸ªå€¼

```shell
æ•°ç»„å[ç´¢å¼•]=å˜é‡å€¼
[root@zutuanxue ~]# asso_array1[linux]=one
[root@zutuanxue ~]# asso_array1[java]=two
[root@zutuanxue ~]# asso_array1[php]=three
```

ä¸€æ¬¡èµ‹å¤šä¸ªå€¼

```shell
[root@zutuanxue ~]# asso_array2=([name1]=harry [name2]=jack [name3]=amy [name4]="Miss zhang")
```

æŸ¥çœ‹å…³è”æ•°ç»„

```shell
[root@zutuanxue ~]# declare -A
declare -A asso_array1='([php]="three" [java]="two" [linux]="one" )'
declare -A asso_array2='([name3]="amy" [name2]="jack" [name1]="harry" [name4]="Miss zhang" )'
```

**å–å€¼**

```shell
[root@zutuanxue ~]# echo ${asso_array1[linux]}
one
[root@zutuanxue ~]# echo ${asso_array1[php]}
three
[root@zutuanxue ~]# echo ${asso_array1[*]}
three two one
[root@zutuanxue ~]# echo ${!asso_array1[*]}
php java linux
[root@zutuanxue ~]# echo ${#asso_array1[*]}
3
[root@zutuanxue ~]# echo ${#asso_array2[*]}
4
[root@zutuanxue ~]# echo ${!asso_array2[*]}
name3 name2 name1 name4
```

## ä¸ƒã€IFåˆ¤æ–­

**è¯­æ³•æ ¼å¼**

- æ ¼å¼1ï¼š **test** æ¡ä»¶è¡¨è¾¾å¼
- æ ¼å¼2ï¼š [ æ¡ä»¶è¡¨è¾¾å¼ ]
- æ ¼å¼3ï¼š [[ æ¡ä»¶è¡¨è¾¾å¼ ]] ï¼ˆæ”¯æŒæ­£åˆ™~ï¼‰

**ç‰¹åˆ«è¯´æ˜ï¼š**

1ï¼‰[ äº²äº²ï¼Œæˆ‘ä¸¤è¾¹éƒ½æœ‰ç©ºæ ¼ï¼Œä¸ç©ºæ‰“æ­»ä½ å‘¦ ] ğŸ‘¿

2ï¼‰[[ äº²äº²ï¼Œæˆ‘ä¸¤è¾¹éƒ½æœ‰ç©ºæ ¼ï¼Œä¸ç©ºæ‰“æ­»ä½ å‘¦ ]]ğŸ‘¿

- if-1.sh :  å•ifè¯­æ³•

  ```shell
  #!/bin/bash
  # åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦ä¸ºroot
  if [ $USER != 'root' ]
  then
      echo "ERROR: need to be root so that"
      exit 1
  fi
  ```

- if-2.sh :  if...else

  ```shell
  #!/bin/bash
  # ç™»é™†äººå‘˜èº«ä»½è®¤è¯
  
  if [ $USER == 'root' ]
          then
                  echo "ç®¡ç†å‘˜ï¼Œ ä½ å¥½"
  else
          echo "guest, ä½ å¥½"
  fi
  ```

- if-3.sh  :  if...elif..else

  ```shell
  #!/bin/bash
  #åˆ¤æ–­å†…å­˜çš„ä½¿ç”¨ç‡
  #60ä»¥ä¸‹    ok ç»¿è‰²  32m
  #60ä»¥ä¸Š    é»„è‰²è­¦å‘Š   33m
  #70ä»¥ä¸Š    ç²‰è‰²ä¸¥é‡è­¦å‘Š 35m 
  #80ä»¥ä¸Š    çº¢è‰²è­¦å‘Š 31m
  if [ $1 -gt 80 ]
  then
          echo -e "\033[31m è­¦å‘Š \033[0m"
  elif [ $1 -gt 70 ]
  then
          echo -e "\033[35m è­¦å‘Š \033[0m" 
  
  elif [ $1 -gt 60 ]
  then
          echo -e "\033[33m è­¦å‘Š \033[0m"
  else
          echo -e "\033[32m OK \033[0m"
  fi
  ```

- if-4.sh  :  if åµŒå¥—if

  ```shell
  #!/bin/bash
  #åˆ¤æ–­ä¸¤ä¸ªæ•´æ•°çš„å…³ç³»
  if [ $1 -ne $2  ]
  then
          if [ $1 -gt $2 ]
          then
                  echo " $1 > $2 "
          else
                  echo " $1 < $2 "
          fi
  else
          echo " $1 = $2 "
  fi
  ```

- if-5.sh  :  if ä¸shellè¿ç®—

  ```shell
  #!/bin/bash
  #åˆ¤æ–­ç›®å½• /tmp/stanlong  æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨å°±åˆ›å»ºä¸€ä¸ª
  if [ ! -d /tmp/stanlong ];then
          mkdir -v /tmp/stanlong
  fi
  ```

- if-6.sh  :  å­—ç¬¦ä¸²åˆ¤æ–­

  ```shell
  #!/bin/bash
  #ç”¨æˆ·ç™»å½•éªŒè¯
  
  read -p "user: " myuser
  if [ -z "$myuser" ];then
          echo "ç”¨æˆ·åä¸ºç©º"
          exit 1
  fi
  
  read -p "password: " mypw
  if [ -n "$mypw" ];then
          if [ "$myuser" == "root" ];then
                  if [ "$mypw" == "abc-123" ];then
                          echo "welcome root"
                  else
                          echo "å¯†ç é”™è¯¯"
                          exit 1
                  fi
          else
                  echo "ç”¨æˆ·åé”™è¯¯"
                  exit 1
          fi
  else
          echo "å¯†ç ä¸èƒ½ä¸ºç©º"
  fi             
  
  ###################################################################################
  
  # ç”¨é€»è¾‘è¿ç®—ç®€å†™ if
  #!/bin/bash
  #ç”¨æˆ·ç™»å½•éªŒè¯
  read -p "user: " myuser
  if [ -z "$myuser" ];then
          echo "ç”¨æˆ·åä¸ºç©º"
          exit 1
  fi
  
  read -p "password: " mypw
  if [ -n "$mypw" ];then
          if [ "$myuser" == "root" ] && [ "$mypw" == "abc-123" ]; then
                  echo "welcome root"
          else
                  echo "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"
                  exit 1
          fi
  else
          echo "å¯†ç ä¸èƒ½ä¸ºç©º"
  fi             
  ```

- if-7.sh  :  æ¡ä»¶ç¬¦å·ä¸­ä½¿ç”¨ (()) ï¼Œ å¯ä»¥åœ¨æ¡ä»¶ä¸­æ¤å…¥æ•°å­¦è¡¨è¾¾å¼

  ```shell
  #!/bin/bash
  if (( (5+5-5)*5/5 > 10 ));then
          echo "yes"
  else
          echo "no"
  fi
  ```

- if-8.sh  :  ä½¿ç”¨åŒæ–¹æ‹¬å·ï¼Œå¯ä»¥åœ¨æ¡ä»¶ä¸­ä½¿ç”¨é€šé…ç¬¦

  ```shell
  #!/bin/bash
  for var in ab ac rx bx rvv vt
  do
          if [[ "$var" == r* ]];then
                  echo "$var"
          fi
  done
  ```

- if-9.sh  :  ç®€å†™if 

  ```shell
  if [ ! -d /tmp/stanlong ];then
          mkdir -v /tmp/stanlong
  fi
  
  å¯ç®€å†™ä¸º
  
  [ ! -d /tmp/stanlong ] && mkdir -v /tmp/stanlong
  
  ##################################################################
  
  if [ $USER == 'root' ]
          then
                  echo "ç®¡ç†å‘˜ï¼Œ ä½ å¥½"
  else
          echo "guest, ä½ å¥½"
  fi
  
  å¯ç®€å†™ä¸º
  [ $USER == 'root' ] && echo "ç®¡ç†å‘˜ï¼Œ ä½ å¥½" || echo "guest, ä½ å¥½"
  ```


## å…«ã€FORå¾ªç¯

for-1.sh  :  åŸºæœ¬è¯­æ³•

```shell
#!/bin/bash
#for i in 1 2 3 4 5 # è¯­æ³•1æšä¸¾ 
#for i in {1..5} # è¯­æ³•2 åˆ—è¡¨
# for i in `seq 1 5`  # è¯­æ³•3 åºåˆ— é»˜è®¤ä»1å¼€å§‹
# for i in $(seq 5) # ä¸ä¸Šé¢çš„èµ‹å€¼æ–¹å¼ç­‰ä»·
# for i in `seq 1 +3 10` # è®¾ç½®æ­¥é•¿ï¼Œ +3 æˆ–è€… -3
for i in {1..10..3}  # è®¾ç½®æ­¥é•¿ï¼Œ1åˆ°10æ¯æ­¥åŠ 3ï¼Œå¦‚æœ{10..1..3},å°±æ˜¯æ¯æ­¥å‡3
do
        echo "$i"
        echo "Long Grant China"
done
```

for-2.sh  :  ä¸å¸¦åˆ—è¡¨å¾ªç¯ï¼Œ å‚æ•°ç”±ç”¨æˆ·ä¼ å…¥

```shell
#!/bin/bash
# å‚æ•°ç”±ç”¨æˆ·ä¼ å…¥
for i 
do
	echo $i
done

[root@node01 ~]# ./for-2.sh 1 2 3 4 5
```

for-3.sh  :  Cè¯­æ³•æ ¼å¼

```shell
#!/bin/bash
for ((i=0; i<=5; i++))
do
	echo $i
done


#########################################

#!/bin/bash
# å®šä¹‰å¤šä¸ªå˜é‡

for ((x=1,y=10; x<=10, y>=1; x++, y--))
do
        echo "$x  $y"
done
```

for-4.sh  :  å¾ªç¯æ§åˆ¶ break

```shell
#!/bin/bash
for i in `seq 1 9`
do
        echo $i
        if [ $i -eq 5 ];then
                break
        fi
done

echo "ok"
```

for-5.sh  :  å¾ªç¯æ§åˆ¶  continue

```shell
#!/bin/bash
for i in `seq 1 9`
do
        if [ $i -eq 5 ];then
                continue
        else
                echo $i
        fi
done
```

for-6.sh  :  å¾ªç¯æ§åˆ¶ sleep  æ§åˆ¶å¾ªç¯èŠ‚å¥

```shell
#!/bin/bash
for ((;;))
do
        echo "Long Great China"
        sleep 1 # é»˜è®¤1s
done
```

for-7.sh  :  å‚æ•°æ§åˆ¶å‘½ä»¤ shift, ä½¿ä½ç½®å‚æ•°å‘å·¦ç§»åŠ¨ï¼Œé»˜è®¤ç§»åŠ¨1ä½ï¼Œå¯ä»¥ä½¿ç”¨ shift N è¡¨ç¤ºå‘å·¦ç§»åŠ¨Nä½ï¼Œä¼ å‚è¦æ˜¯Nçš„æ•´æ•°å€

```shell
#!/bin/bash
[ $# -lt 3 ] && echo "è¯·è¾“å…¥è‡³å°‘ä¸‰ä¸ªå‚æ•°: " $0 '$1 $2 $3 ...' && exit 1
count=$#

for ((i=1; i<= $count; i++))
do
        echo "å‚æ•°æ•°é‡ï¼š $#"
        echo "å½“å‰$1çš„æ•°å€¼æ˜¯ï¼š'$1'"
        shift 1
        sleep 1
done
echo "æ‰§è¡Œå®Œæ¯•"
```

for-8.sh  :  è„šæœ¬é€€å‡ºå‘½ä»¤ exitï¼Œ é€€å‡ºè„šæœ¬ï¼Œé‡Šæ”¾æ‰§è¡Œè¯¥è„šæœ¬æ—¶ç”³è¯·çš„æ‰€æœ‰èµ„æº

```shell
#!/bin/bash
for i in `seq 1 9`
do
        echo $i
        if [ $i -eq 5 ];then
                exit 0 # é€€å‡ºä»£ç ï¼Œä¸ç»§ç»­å¾€ä¸‹æ‰§è¡Œ
        fi
done
echo "æ‰§è¡Œå®Œæ¯•"
```

for-9.sh  :  å¾ªç¯åµŒå¥— ä¹ä¹ä¹˜æ³•è¡¨

```shell
#!/bin/bash
for ((x=1; x<=9; x++))
do
        for ((y=1; y<=$x; y++))
        do
                echo -n -e "$x * $y = $((x * y)) \t"
        done
        echo
done
```

for-10  :  éå†æ•°ç»„

```shell
#!/bin/bash
name=('æ²ˆä¸‡ä¸‰' 'æœ±å…ƒç’‹' 'åˆ˜ä¼¯æ¸©' 'å—æµ·è´¢ç¥' 'æ¼ åŒ—å¯Œå©†')
count=${#name[*]} # æ±‚æ•°ç»„é•¿åº¦

for ((i=0; i<$count; i++))
do
        echo "name[$i]=${name[$i]}"
done

################################################################################################

#!/bin/bash
# å¾ªç¯å¾€æ•°ç»„ä¸­èµ‹å€¼
for ((i=0; i<3; i++))
do
        read -p "name: " name
        names[$i]=$name
done


count=${#names[*]}


for ((i=0; i<$count; i++))
do
        echo "names[$i]=${names[$i]}"
done
```

## ä¹ã€whileå¾ªç¯

while-1.sh  :   åŸºæœ¬è¯­æ³•

```shell
#!/bin/bash
i=1
while [ $i -lt 10 ]
do
        echo $i
        #i=$((i+1)) æˆ–è€…åƒå¦‚ä¸‹ä½¿ç”¨ i++ çš„æ–¹å¼
        let i++
done
```

while-2.sh  :   å­—ç¬¦æ¯”è¾ƒ

```shell
#!/bin/bash
read -p "è¯·è¾“å…¥ä¸€ä¸ªå­—ç¬¦[æŒ‰'Q'é€€å‡º]: " choose
while [ $choose != 'Q' ]
do
        echo "è¾“å…¥çš„å­—ç¬¦æ˜¯: $choose"
        read -p "è¯·è¾“å…¥ä¸€ä¸ªå­—ç¬¦[æŒ‰'Q'é€€å‡º]: " choose
done
```

while-3.sh   :  é€»è¾‘è¿ç®—

```shell
#!/bin/bash
read -p "M:" m
read -p "C:" c
read -p "H:" h

while [ $m -lt 10000 ] || [ $c -lt 1 ] || [ $h -lt 2 ];do
        echo "out"
        read -p "M:" m
        read -p "C:" c
        read -p "H:" h
done
echo "welcome"
```

while-4.sh  :  æ–‡ä»¶è¿ç®—

```shell
#!/bin/bash
while [ ! -d /tmp/stanlong ]
do
        echo "æ–‡ä»¶ä¸å­˜åœ¨"
        sleep 1
done
```

while-5.sh  :  ç‰¹æ®Šæ¡ä»¶

```shell
!/bin/bash
#while true æˆ–è€…å†™æˆ while : 
while :
do
        echo "æ— æ¯å¸ï¼Œå‹¿å®Œç‰©"
        sleep 1
done

# false ä»£è¡¨å‡
```

## åã€untilå¾ªç¯

```shell
è¯­æ³•ï¼š
until [condition] # æ¡ä»¶ä¸ºå‡ until æ‰ä¼šå¾ªç¯ï¼Œæ¡ä»¶ä¸ºçœŸï¼Œuntilåœæ­¢å¾ªç¯
do
	commands
done
```

untiil-1.sh  :  until å¾ªç¯

```shell
#!/bin/bash
#!/bin/bash
i=1
until [ $i -gt 5 ]
do
        echo $i
        let i++
done

################################################################################################

#!/bin/bash
# until æ— é™å¾ªç¯
until false
do
        echo "Long Great China"
        sleep 1
done
```

## åä¸€ã€å‡½æ•°ä¸case

```shell
#è¯­æ³•1
å‡½æ•°å (){
	ä»£ç å—
	return N
}

#è¯­æ³•2ï¼Œ å‡½æ•°åå¯ä»¥ä¸ç”¨åŠ æ‹¬å·
function å‡½æ•°å{ 
	ä»£ç å—
	return N
}

# return é»˜è®¤è¿”å›å‡½æ•°ä¸­æœ€åä¸€ä¸ªå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ï¼Œä¹Ÿå¯ä»¥ç»™å®šå‚æ•°å€¼ï¼Œè¯¥å‚æ•°å€¼çš„èŒƒå›´æ˜¯0-256ä¹‹é—´
# å¦‚æœæ²¡æœ‰returnï¼Œ å‡½æ•°å°†è¿”å›æœ€åä¸€ä¸ªShellçš„é€€å‡ºå€¼
```

func1.sh  :  å‡½æ•°çš„åŸºæœ¬è¯­æ³•ä¸è°ƒç”¨

```shell
#!/bin/bash
fun1 ()
{
        echo "fun1"
}

function fun2
{
        echo "func2"
}

# è°ƒç”¨å‡½æ•°
fun1;fun2
```

### case è¯­å¥

```shell
# è¯­æ³•

case å˜é‡ in
æ¡ä»¶1)
	æ‰§è¡Œä»£ç å—1
;;
æ¡ä»¶2)
	æ‰§è¡Œä»£ç å—2
;;
*)                     # default å¦‚æœä»¥ä¸Šæ¡ä»¶ä¸æ»¡è¶³ï¼Œé»˜è®¤æ‰§è¡Œ *) ä¸‹é¢çš„è¯­å¥
	æ‰§è¡Œä»£ç å—3
;;
esac

# æ¯ä¸ªä»£ç å—æ‰§è¡Œå®Œæ¯•è¦ä»¥;;ç»“å°¾ä»£è¡¨ç»“æŸï¼Œ case ç»“å°¾è¦ä»¥å€’è¿‡æ¥å†™çš„ esac ç»“æŸ
```

```shell
#!/bin/bash
read -p "æ€§åˆ«: " gender

case $gender in
        B|b|ç”·)
                echo "å…ˆç”Ÿï¼Œæ‚¨å¥½"
                ;;
        G|g|å¥³)
                echo "å¥³å£«ï¼Œæ‚¨å¥½"
                ;;
        *)
                echo "è¯·è¾“å…¥æ€§åˆ«"
esac
```

### è°ƒè¯•è„šæœ¬

```shell
bash -a test.sh #   -a ä¸€èˆ¬ç”¨äºæ’é”™ï¼ŒæŸ¥çœ‹è„šæœ¬çš„æ‰§è¡Œè¿‡ç¨‹
bash -n test.sh #   -n ç”¨æ¥æŸ¥çœ‹è„šæœ¬çš„è¯­æ³•æ˜¯å¦æœ‰é—®é¢˜
```

## åäºŒã€sedå‘½ä»¤

```shell
è¯­æ³•: sed [options] '{command}[flags]' [filename]

[options]ï¼š
-n ï¼šä½¿ç”¨å®‰é™(silent)æ¨¡å¼ã€‚åŠ ä¸Š -n å‚æ•°åï¼Œåˆ™åªæœ‰ç»è¿‡sed ç‰¹æ®Šå¤„ç†çš„é‚£ä¸€è¡Œ(æˆ–è€…åŠ¨ä½œ)æ‰ä¼šè¢«åˆ—å‡ºæ¥ã€‚
-e ï¼šç›´æ¥åœ¨å‘½ä»¤åˆ—æ¨¡å¼ä¸Šè¿›è¡Œ sed çš„åŠ¨ä½œç¼–è¾‘,å¯åŒæ—¶æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œç”¨;åˆ†éš”
-f ï¼šç›´æ¥å°† sed çš„åŠ¨ä½œå†™åœ¨ä¸€ä¸ªæ–‡ä»¶å†…ï¼Œ -f filename åˆ™å¯ä»¥è¿è¡Œ filename å†…çš„ sed åŠ¨ä½œï¼›
-r ï¼šsed çš„åŠ¨ä½œæ”¯æŒçš„æ˜¯å»¶ä¼¸å‹æ­£åˆ™è¡¨ç¤ºæ³•çš„è¯­æ³•ã€‚(é»˜è®¤æ˜¯åŸºç¡€æ­£åˆ™è¡¨ç¤ºæ³•è¯­æ³•)
-i ï¼šç›´æ¥ä¿®æ”¹è¯»å–çš„æ–‡ä»¶å†…å®¹ï¼Œè€Œä¸æ˜¯è¾“å‡ºåˆ°ç»ˆç«¯ã€‚
-i.xx : å…ˆå¤‡ä»½æ–‡ä»¶åœ¨æ“ä½œ


{command}ï¼š
a ï¼šè¿½åŠ ï¼Œ a çš„åé¢å¯ä»¥æ¥å­—ç¬¦ä¸²ï¼Œè€Œè¿™äº›å­—ä¸²ä¼šåœ¨æ–°çš„ä¸€è¡Œå‡ºç°(å½“å‰è¡Œçš„ä¸‹ä¸€è¡Œ)ï½
c ï¼šå–ä»£ï¼Œ c çš„åé¢å¯ä»¥æ¥å­—ç¬¦ä¸²ï¼Œè¿™äº›å­—ä¸²å¯ä»¥å–ä»£ n1,n2 ä¹‹é—´çš„è¡Œï¼
d ï¼šåˆ é™¤ï¼Œå› ä¸ºæ˜¯åˆ é™¤å•Šï¼Œæ‰€ä»¥ d åé¢é€šå¸¸ä¸æ¥ä»»ä½•å’šå’šï¼›
i ï¼šæ’å…¥ï¼Œ i çš„åé¢å¯ä»¥æ¥å­—ä¸²ï¼Œè€Œè¿™äº›å­—ä¸²ä¼šåœ¨æ–°çš„ä¸€è¡Œå‡ºç°(ç›®å‰çš„ä¸Šä¸€è¡Œ)ï¼›
p ï¼šåˆ—å°ï¼Œäº¦å³å°†æŸä¸ªé€‰æ‹©çš„æ•°æ®å°å‡ºã€‚é€šå¸¸ p ä¼šä¸å‚æ•° sed -n ä¸€èµ·è¿è¡Œï½
s ï¼šå–ä»£ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œå–ä»£çš„å·¥ä½œå“©ï¼é€šå¸¸è¿™ä¸ª s çš„åŠ¨ä½œå¯ä»¥æ­é…æ­£è§„è¡¨ç¤ºæ³•ï¼ä¾‹å¦‚ 1,20s/old/new/g å°±æ˜¯å•¦ï¼
y ï¼šè½¬æ¢ N D P ï¼ˆå¤§å°å†™è½¬æ¢ï¼‰

[flags]
æ•°å­—                 è¡¨ç¤ºç”¨æ–°æ–‡æœ¬æ›¿æ¢æŒ‡å®šä½ç½®å¤„çš„å†…å®¹
g:                  è¡¨ç¤ºç”¨æ–°æ–‡æœ¬æ›¿æ¢ç°æœ‰æ–‡æœ¬å…¨éƒ¨åŒ¹é…åˆ°çš„å†…å®¹
p:                  è¡¨ç¤ºæ‰“å°åŸå§‹çš„å†…å®¹
w filename:         å°†æ›¿æ¢çš„ç»“æœå†™å…¥æ–‡ä»¶
```

```shell
# å‡†å¤‡æ•°æ®æ–‡ä»¶ test.txt
1 the quick brown fox jumps over the lazy dog.
2 the quick brown fox jumps over the lazy dog.
3 the quick brown fox jumps over the lazy dog.
4 the quick brown fox jumps over the lazy dog.
5 the quick brown fox jumps over the lazy dog.

# è¡Œåæ’å…¥
sed 'ahello world' test.txt # åœ¨æ¯è¡Œåé¢éƒ½æ–°å¢ä¸€è¡Œ hello worldï¼Œ ä¸ºæ–¹ä¾¿åŒºåˆ†å‘½ä»¤ï¼Œå‘½ä»¤åé¢åŠ ä¸€ä¸ªè½¬ä¹‰\
sed 'a\hello world' test.txt # åœ¨æ¯è¡Œåé¢éƒ½æ–°å¢ä¸€è¡Œ hello world
sed '3a\hello world' test.txt # åœ¨ç¬¬ä¸‰è¡Œåé¢æ–°å¢ä¸€è¡Œ hello world
sed '2,4a\hello world' test.txt # åœ¨ç¬¬2ï¼Œ3ï¼Œ4åé¢æ–°å¢ä¸€è¡Œ hello world
sed '/^3 the/a\hello world' test.txt # åœ¨åŒ¹é…åˆ°ä»¥ 3 the å¼€å¤´çš„è¡Œåé¢è¿½åŠ ä¸€è¡Œ hello world

# è¡Œå‰æ’å…¥
sed 'i\hello world' test.txt # åœ¨æ¯è¡Œå‰é¢è¿½åŠ  hello world
sed '3i\hello world' test.txt # åœ¨ç¬¬ä¸‰è¡Œå‰é¢è¿½åŠ  hello world

# åˆ é™¤
sed 'd' test.txt # åˆ é™¤æ‰€æœ‰
sed '3d' test.txt # åˆ é™¤ç¬¬ä¸‰è¡Œ

# æŸ¥æ‰¾æ›¿æ¢
sed 's/dog/cat/' test.txt # æŠŠ dog æ¢æˆ cat

# æ›´æ”¹
sed 'c\hello world' test.txt # æŠŠæ¯è¡Œçš„å†…å®¹éƒ½æ”¹æˆ hello world
sed '3c\hello world' test.txt # æŠŠç¬¬ä¸‰è¡Œçš„å†…å®¹æ”¹æˆ hello world
sed '2,4c\hello world' test.txt # æŠŠç¬¬2,3,4è¡Œçš„å†…å®¹å…ˆåˆ é™¤ï¼Œæ›¿æ¢æˆ hello world

# è½¬æ¢
sed 'y/abc/CDF/' test.txt

# æ–°å¢æ•°æ®è¡Œ
5 the quick brown fox jumps over the lazy dog.dog.dog

# æ ‡å¿—ä½
sed 's/dog/cat/2' test.txt # æŠŠç¬¬äºŒå¤„çš„ dog æ›¿æ¢æˆdog
sed 's/dog/cat/new_file.txt' test.txt # æŠŠæ›¿æ¢åçš„æ–‡ä»¶ä¿å­˜åˆ° new_file.txt

# å°æŠ€å·§
sed -n '$=' test.txt # ç»Ÿè®¡æ–‡ä»¶è¡Œå·
----------------------------------------------------------------------------------------------------------------------------
# åªè¾“å‡ºæ“ä½œè¡Œ
# æ‰“å°ç¬¬ä¸€è¡Œåˆ°ç¬¬ä¸‰è¡Œï¼Œ ä¼šå‘ç°ç¬¬ä¸€è¡Œå’Œç¬¬ä¸‰è¡Œè¾“å‡ºäº†ä¸¤éï¼Œä¸éœ€è¦çš„è¡Œä¹Ÿè¾“å‡ºäº†ã€‚
sed '1,3p' test.txt 
1 the quick brown fox jumps over the lazy dog.
1 the quick brown fox jumps over the lazy dog.
2 the quick brown fox jumps over the lazy dog.
2 the quick brown fox jumps over the lazy dog.
3 the quick brown fox jumps over the lazy dog.
3 the quick brown fox jumps over the lazy dog.
4 the quick brown fox jumps over the lazy dog.
5 the quick brown fox jumps over the lazy dog.

# åªæ‰“å°ç¬¬ä¸€è¡Œåˆ°ç¬¬ä¸‰è¡Œ
sed -n '1,3p' test.txt 
1 the quick brown fox jumps over the lazy dog.
2 the quick brown fox jumps over the lazy dog.
3 the quick brown fox jumps over the lazy dog.

# æ‰“å°ç¬¬ä¸‰è¡Œæœ€åä¸€è¡Œï¼Œ æœ€åä¸€è¡Œç”¨ $è¡¨ç¤º
sed -n '3,$p' test.txt 
3 the quick brown fox jumps over the lazy dog.
4 the quick brown fox jumps over the lazy dog.
5 the quick brown fox jumps over the lazy dog.
```

## åä¸‰ã€awkå‘½ä»¤

awkæ˜¯ä¸€ç§å¯ä»¥å¤„ç†æ•°æ®ã€äº§ç”Ÿæ ¼å¼åŒ–æŠ¥è¡¨çš„è¯­è¨€ï¼Œå®ƒå°†æ¯ä¸€è¡Œæ•°æ®è§†ä¸ºä¸€æ¡è®°å½•ï¼Œæ¯æ¡è®°å½•ä»¥å­—æ®µåˆ†éš”ç¬¦åˆ†éš”ï¼Œç„¶åè¾“å‡ºå„ä¸ªå­—æ®µçš„å€¼ã€‚

```shell
è¯­æ³•:
awk [options]'[BEGIN]{program}[END]'[file]

options
-F	æŒ‡å®šåˆ†éš”ç¬¦
-f	è°ƒç”¨è„šæœ¬
-v	å®šä¹‰å˜é‡ var=value

'[BEGIN]{program}[END]'
æ³¨æ„ï¼šawkç¨‹åºç”±å·¦å¤§æ‹¬å·å’Œå³å¤§æ‹¬å·å®šä¹‰ï¼Œ ç¨‹åºå¿…é¡»æ”¾åœ¨ä¸¤ä¸ªå¤§æ‹¬å·ä¹‹é—´ã€‚ç”±äºawkå‘½ä»¤è¡Œå‡å®šç¨‹åºæ˜¯å•æ–‡æœ¬å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å¿…é¡»å°†ç¨‹åºåŒ…æ‹¬åœ¨å•å¼•å·å†…ã€‚
awkç¨‹åºè¿è¡Œä¼˜å…ˆçº§æ˜¯:
	1) BEGIN : 		åœ¨å¼€å§‹æ‰§è¡Œæ•°æ®æµä¹‹å‰æ‰§è¡Œï¼Œå¯é€‰é¡¹
	2) program : 	æ•°æ®æµå¤„ç†é€»è¾‘ï¼Œå¿…é€‰é¡¹
	3) END : 		å¤„ç†å®Œæ•°æ®æµåæ‰§è¡Œï¼Œå¯é€‰é¡¹
-------------------------------------------------------------------------------	
awk å¯¹å­—æ®µ(åˆ—)çš„æå–
$0 è¡¨ç¤ºå…¨éƒ¨æ–‡æœ¬
$1 æ–‡æœ¬çš„ç¬¬ä¸€åˆ—
$2 æ–‡æœ¬çš„ç¬¬äºŒåˆ—
$N æ–‡æœ¬çš„ç¬¬Nåˆ—
$NF æ–‡æœ¬çš„æœ€åä¸€åˆ—

awk '{print $0}' test.txt # æ‰“å°æ•´ä¸ªæ–‡æœ¬
awk '{print $1}' test.txt # æ‰“å°æ–‡æœ¬ç¬¬1åˆ—
awk '{print $1, $6}' test.txt # æ‰“å°æ–‡æœ¬ç¬¬1åˆ—å’Œç¬¬6åˆ—
awk '{print $NF}' test.txt # æ‰“å°æ–‡æœ¬æœ€å1åˆ—

-------------------------------------------------------------------------------
- æ”¯æŒå†…ç½®å˜é‡
  - ARGC å‘½ä»¤è¡Œå‚æ•°ä¸ªæ•°
  - ARGV å‘½ä»¤è¡Œå‚æ•°æ’åˆ—
  - ENVIRON æ”¯æŒç³»ç»Ÿç¯å¢ƒå˜é‡çš„ä½¿ç”¨
  - FILENAME awk æµè§ˆçš„æ–‡ä»¶å
  - FNR æµè§ˆæ–‡ä»¶çš„è®°å½•æ•°
  - FS è®¾ç½®è¾“å…¥åŸŸåˆ†éš”ç¬¦ï¼Œç­‰ä»·äºå‘½ä»¤è¡Œ-Fé€‰é¡¹
  - NF æŒ‰åˆ†éš”ç¬¦åˆ†éš”çš„å­—æ®µæ•°
  - NR è¡Œå·
  - FS è¾“å…¥å­—æ®µåˆ†éš”ç¬¦
  - OFS è¾“å‡ºå­—æ®µåˆ†éš”ç¬¦
  - RS è¾“å…¥è®°å½•åˆ†éš”ç¬¦
  - ORS è¾“å‡ºè®°å½•åˆ†éš”ç¬¦
  - FIELDWIDTHS ä»¥ç©ºæ ¼åˆ†éš”çš„æ•°å­—åˆ—è¡¨ï¼Œç”¨ç©ºæ ¼å®šä¹‰æ¯ä¸ªæ•°æ®å­—æ®µçš„ç²¾ç¡®å®½åº¦

  
# awk å¯¹è¡Œçš„æå–
awk 'NR==3{print $0}' test.txt # æ‰“å°ç¬¬ä¸‰è¡Œ
awk -F ":" 'NR==1{print $1,$3,$5}' /etc/passwd # æŒ‰:åˆ†éš”ï¼Œæ‰“å° passwdç¬¬ä¸€è¡Œï¼Œç¬¬ä¸€ä¸‰äº”åˆ—
egrep "^root" /etc/passwd|awk -F ":" '{print $1 "-" $3 "-" $NF}' # è‡ªå®šä¹‰åˆ—ä¹‹é—´çš„åˆ†éš”ç¬¦ä¸º "-"
awk -F: '$1=="root"{print $1 "-" $3 "-" $NF}' /etc/passwd # æ‰“å°ç¬¬ä¸€åˆ—ä¸ºrootçš„è¡Œ
awk -F: '$1 ~ "^ro"{print $1 "-" $3 "-" $NF}' /etc/passwd # æˆ–è€…æ˜¯ç”¨æ¨¡ç³ŠåŒ¹é…çš„å†™æ³• ~ æ˜¯åŒ¹é…ç¬¦

# æŒ‰åº§æ ‡æå–
awk -F: 'NR==1{print $1}' /etc/passwd # æ‰“å°ç¬¬ä¸€è¡Œç¬¬ä¸€åˆ—çš„å€¼


-------------------------------------------------------------------------------
awk å®šä¹‰å˜é‡
awk 'BEGIN{name="stanlong";print name}' # æ–¹å¼1
awk -v 'count=0' 'BEGIN{count++; print count}' # æ–¹å¼2

awk å®šä¹‰æ•°ç»„
awk 'BEGIN{array[1]="stanlong";array[2]=18;print array[1],array[2]}'

awk åŒ¹é…
awk -F: '$1=="root"{print $0}' passwd # ç²¾ç¡®åŒ¹é…
awk -F: '$1 ~ "^ro"{print $0}' passwd # æ¨¡ç³ŠåŒ¹é…
awk -F: '$1 != "root"{print $0}' passwd # ç²¾ç¡®ä¸åŒ¹é…

-------------------------------------------------------------------------------
awk æµç¨‹æ§åˆ¶
# æ•°æ®å‡†å¤‡
cat data
65	50	100
150	30	10
151	100	40

# if
awk '{
if($1<5)
	print $1*2
else
	print $1/2
}' data


# for
awk -v 'sum=0' '{
for(i=1;i<4;i++)
	sum+=$i
print sum
}' data

# while
awk '{
sum=0
i=1
while(i<4){
	sum+=$i
	i++
}
print snum
}' data

# do while
awk '{
sum=0
i=1
do{
sum+=$i
i++
}while(sum<150)
print sum
}' data

# break
awk '{
sum=0
i=1
while(i<4){
	sum+=$i
	if(sum>150)
		break
	i++
}
print sum
}' data


-------------------------------------------------------------------------------
awk å°æŠ€å·§
# æ‰“å°æ–‡æœ¬å…±æœ‰å¤šå°‘è¡Œ
awk 'END{print NR}' data
# æ‰“å°æ–‡æœ¬æœ€åä¸€è¡Œ
awk 'END{print $0}' data
# æ‰“å°æ–‡æœ¬å…±æœ‰å¤šå°‘åˆ—
awk 'END{print NF}' data
# å»é‡
awk '!($1 in a){a[$1];print $1}'
```





